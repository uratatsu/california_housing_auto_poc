# カリフォルニア住宅価格予測モデル 実験レポート

## 1. 実験概要

### 1.1 目的
- カリフォルニア住宅データセットを用いて、住宅価格（HousingPrices）の予測モデルを構築
- LightGBMを用いた回帰モデルの実装と評価

### 1.2 データセット情報
- 総サンプル数: 20,640件
- 特徴量数: 8（基本特徴量）+ 4（派生特徴量）
- ターゲット変数: HousingPrices（住宅価格）

## 2. モデリング手法

### 2.1 特徴量エンジニアリング
以下の特徴量を作成し、モデルに使用:

**基本特徴量**:
- MedInc: 地域の世帯収入中央値
- HouseAge: 住宅の築年数
- AveRooms: 平均部屋数
- AveBedrms: 平均寝室数
- Population: 人口
- AveOccup: 平均世帯人数
- Latitude: 緯度
- Longitude: 経度

**派生特徴量**:
- bedroom_ratio: 部屋あたりの寝室の割合（AveBedrms / AveRooms）
- population_density: 人口密度（Population / AveOccup）
- location_cluster: 地域特性（Latitude * Longitude）
- income_rooms: 収入と部屋数の相互作用（MedInc * AveRooms）

### 2.2 モデル設定
**LightGBMパラメータ**:
```yaml
objective: regression
metric: rmse
boosting_type: gbdt
num_leaves: 31
learning_rate: 0.05
feature_fraction: 0.9
n_estimators: 100
```

### 2.3 評価手法
- 5分割クロスバリデーション
- テストデータ分割比率: 20%
- 評価指標: RMSE（平均二乗誤差の平方根）

## 3. 実験結果

### 3.1 モデル性能
**クロスバリデーション結果**:
- CV平均RMSE: 0.4877 ± 0.0121
- 各フォールドのRMSE:
  - Fold 1: 0.5039
  - Fold 2: 0.4817
  - Fold 3: 0.4765
  - Fold 4: 0.5006
  - Fold 5: 0.4757

**テストデータ結果**:
- テストRMSE: 0.4834

### 3.2 結果の解釈
1. **モデルの安定性**:
   - クロスバリデーションの結果が0.47〜0.50の範囲に収まっており、モデルは安定している
   - 標準偏差が小さい（0.0121）ことから、モデルの予測が安定している

2. **汎化性能**:
   - テストRMSEがCV平均RMSEと近い値を示している
   - これは過学習が起きていない証拠であり、モデルが未知のデータに対しても同様の性能を発揮できることを示唆

3. **予測精度の解釈**:
   - RMSEが約0.48というのは、予測値が実際の住宅価格から平均して0.48単位程度ずれることを意味する
   - これは元のデータのスケールを考慮すると、比較的良好な予測精度と言える

## 4. 改善案と今後の方向性

### 4.1 特徴量エンジニアリング
1. **地理的特徴の強化**:
   - 緯度経度から主要都市までの距離を計算
   - 地域クラスタリングの実施

2. **住宅特性の詳細化**:
   - 部屋数と人口の比率
   - 築年数と地域収入の相互作用

### 4.2 モデルチューニング
1. **ハイパーパラメータの最適化**:
   - ベイズ最適化による自動チューニング
   - 学習率とツリーの深さの調整

2. **アンサンブル手法の検討**:
   - 異なるアルゴリズムとのスタッキング
   - バギング・ブースティングの組み合わせ

### 4.3 その他の改善案
1. **データ拡充**:
   - 外部データの追加（地域の経済指標など）
   - 時系列データの活用（可能な場合）

2. **モデル解釈性の向上**:
   - SHAP値による特徴量重要度分析
   - 部分依存プロットによる特徴量の影響度確認

## 5. 結論
- 初期実験として十分な予測精度を達成
- モデルは安定しており、過学習の兆候も見られない
- さらなる改善の余地があり、上記の改善案を順次検証することを推奨 